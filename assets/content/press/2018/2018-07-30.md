title: "Mapping Species for Half-Earth"
date: 2018-07-30
permalink: /press/2018/08/mol-half-earth-google-earth-engine
byline: Medium

The Significance of Biodiversity

Biodiversity is the variety of life on Earth, the building blocks of functioning ecosystems that provide the natural services on which all life depends, including people. Species, the fundamental units of biodiversity, are in the midst of an extinction crisis, losing ground globally at a rate 1,000 times greater than at any time in human history due to factors like habitat loss and climate change.

How do we stop this? Knowing where species live and the pressures threatening them is paramount in reversing the extinction crisis and maintaining the health of our planet, for ourselves and for future generations. As the impact of humans increasingly encroaches on critical habitats everywhere, determining ‘where’ to protect is just as critical as ‘how much’ to protect.


The Half-Earth Project
In his book, Half-Earth, acclaimed biologist Edward O. Wilson proposed a solution commensurate with the problem: conserve half the Earth’s land and sea to protect the bulk of biodiversity from extinction. Scientists agreed that this proposal was both necessary and possible.

“In order to stave off the mass extinction of species, including our own, we must move swiftly to preserve the biodiversity of our planet.” — E.O. Wilson
Born from his book and built on a solid scientific foundation, the Half-Earth Project is working to conserve half the Earth by protecting sufficient habitat to reverse the species extinction crisis and ensure the long-term health of our planet.

The next question the Half-Earth Project needed to answer was, which Half?

Mapping Half-Earth

Enter Map of Life. Map of Life is a core tool of the Half-Earth Project, which is working to identify and prioritize areas of greatest biodiversity value, and communicate this information in new, dynamic, and engaging ways.

Based out of Yale University and the University of Florida, Map of Life assembles, integrates, and analyzes data on global species distributions. It brings together a wealth of information, assessing information on nearly 100,000 species from hundreds of data sources with multiple data types.

Building on several years of close collaboration with Google, Map of Life leverages Google Cloud Platform services to support biodiversity research, monitoring, education, and decision-making. By leveraging an enormous biodiversity database and a suite of spatial modeling tools, Map of Life is able to capture detailed patterns of species distributions at planetary scale.


Today, the Half-Earth Project Map is using new and existing data and applying cutting-edge capabilities of Google Cloud Platform with the goal of mapping terrestrial, marine, and freshwater species at up to 1 kilometer resolution.


Science-Driven Conservation: A big data problem using Google Cloud Platform solutions
Data Warehousing
For an initial set of analyses we leveraged the PostGIS suite of spatial functions to measure expected species presence by overlaying species range map polygons with a global grid composed of approximately 110 km x 110 km cells.

Outputs from these intersections are stored on Google Cloud Storage and imported to the BigQuery data warehousing service. The speed at which BigQuery can aggregate across large tables and compute metrics has been vital for analyzing large volumes of biodiversity data. This is increasingly important as the Half-Earth Project continues to add new species groups and generates higher resolution predictions of where species occur. Tables currently in the hundreds of millions of rows may scale to billions or trillions of rows as our taxonomic and spatial resolution increases. The low storage cost and transaction-based pricing BigQuery offers allows us to query and aggregate tables of such size without the maintenance and overhead required by a traditional data warehouse solution.


Measuring Biodiversity
One aspect of our work measured biodiversity data in two ways: richness and range rarity.

Richness is the number of species occurring, or expected to occur, within a given area. Richness is the simplest way to measure biodiversity.

Range rarity is a continuous metric of range-restrictedness and crucial for considering species with very small ranges that are often of greatest conservation concern. Range rarity is a close proxy for the irreplaceability of a location when the goal is to conserve as many species as possible.

Determining Goals for Species Protection
Another aspect of our analysis included estimating the amount of land already protected within any given ca. 100km cells grid cell (mentioned above). To map the protected area network, we filtered the World Database of Protected Areas, which became available as an Earth Engine public table asset in 2017, to remove redundant reserves and so called “paper-parks” that lack on-the-ground biodiversity protection. For areas that lack a geometry and only include a point location and reserve area, we generated a polygon by buffering the point provided to the size of the park. We then computed the area protected within each grid cell, and exported the results to Cloud Storage.


While no habitat loss is ideal, species with larger range sizes can generally afford to lose more habitat than those with smaller ranges. Accordingly, we determined individual species “protected” status based on range size and the proportion of their range that is protected. As the amount of protected area increases, the number of species protected also increases.

But what is good for one species group is not necessarily ideal for another, and what is good for the whole of biodiversity may leave small groups vulnerable.

To address this, we leveraged BigQuery’s support for user defined functions (UDF) and computed adequate protection levels with a simple javascript function. Given the ability to apply this test to each species, we ranked grid cells for each species group and tested to see how many species’ global protections met the criteria via a BigQuery window function run across the ranked grid.


Progress toward Half-Earth will be measured as a running total of conservation protections, with the ultimate goal being half the Earth’s land and sea. BigQuery window functions allow this to be computed quickly for each cell in the grid. As we selected breakpoints up to 50% of the Earth’s area, we tested each species with our function to see whether it met its minimum protected area, then counted the number of species that met the criteria for each step in the scenario.

Putting It Together
To ensure rapid map tile delivery to the globe, we generated and exported static tilesets to Cloud Storage using Earth Engine’s Export.map.toCloudStorage() feature. This meant exporting compiled data as CSV from BigQuery, which can be re-joined to the grid Shapefile using OGR command line tools and ingested to Earth Engine as a table asset. From there we were able to visualize and explore the data in the Earth Engine code editor and export tiles once we were satisfied with the appearance.


Finally, with our Cloud Storage bucket populated with map tiles and data to drive charts and infographics, the front-end wizards at Vizzuality plugged in to our API to bring it all to life on the Half-Earth Map.

The Half-Earth Map pieces together species distribution data, the protected areas map, and a mask of human activities into a single map useful to scientists, conservationists, communities, decision-makers and anyone interested in biodiversity and the health of our planet.

View article on [Medium](https://medium.com/google-earth/mapping-species-for-half-earth-321a4b2f7624)
